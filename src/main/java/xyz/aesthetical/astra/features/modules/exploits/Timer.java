package xyz.aesthetical.astra.features.modules.exploits;

import net.minecraftforge.event.entity.living.LivingEvent;
import net.minecraftforge.fml.common.eventhandler.SubscribeEvent;
import xyz.aesthetical.astra.Astra;
import xyz.aesthetical.astra.features.settings.NumberSetting;
import xyz.aesthetical.astra.managers.modules.Module;
import xyz.aesthetical.astra.mixin.mixins.IMinecraft;
import xyz.aesthetical.astra.mixin.mixins.world.ITimer;

@Module.Mod(name = "Timer", description = "Makes the game faster or slower")
@Module.Info(category = Module.Category.EXPLOITS)
public class Timer extends Module {
    public final NumberSetting speed = register(new NumberSetting("Speed", 2.0f).setMin(0.1f).setMax(20.0f).setDescription("How fast the game should be"));

    @Override
    public void onDisabled() {
        if (Module.fullNullCheck()) {
            ((ITimer) ((IMinecraft) Astra.mc).getTimer()).setTickLength(1000.0f / 20.0f);
        }
    }

    @SubscribeEvent
    public void onUpdate(LivingEvent.LivingUpdateEvent event) {
        if (Module.fullNullCheck() && event.getEntityLiving() == Astra.mc.player) {
            ((ITimer) ((IMinecraft) Astra.mc).getTimer()).setTickLength(50.0f / speed.getValue().floatValue());
        }
    }
}
